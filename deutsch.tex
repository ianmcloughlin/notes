\documentclass{iansnotes}

\title{Deutsch's Algorithm}
\author{ian.mcloughlin@atu.ie}
\date{Last updated: \today}

\begin{document}
 
\maketitle 

\marginnote{\bibentry{qiskitdeutsch}}
\begin{quantikz}[slice all, slice style=gray, slice titles={$\ket{\psi_\col}$}]
  \lstick{$\ket{0}$} & &  & \gate{H} & \gate[2][20mm]{U}\gateinput{$x$}\gateoutput{$x$} & \gate{H} & \meter{} & \setwiretype{c} \\
  \lstick{$\ket{0}$} & & \gate{X} & \gate{H} & \gateinput{$x$}\gateoutput{$y \oplus f(x)$}    &          &          &                  
\end{quantikz} \\[16mm]
$\ket{\psi_1} = \ket{0} \otimes \ket{0} = \ket{00} \rightarrow \begin{bmatrix} 1 \\ 0 \end{bmatrix} \otimes \begin{bmatrix} 1 \\ 0 \end{bmatrix} = \begin{bmatrix} 1 \begin{bmatrix} 1 \\ 0 \end{bmatrix} \\[6mm] 0 \begin{bmatrix} 1 \\ 0 \end{bmatrix} \end{bmatrix} = \begin{bmatrix} 1 \\ 0 \\ 0 \\ 0 \end{bmatrix}$ \\[16mm]
$\ket{\psi_2} = (I \otimes X) \ket{\psi_1} = \begin{bmatrix} 0 & 1 & 0 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \end{bmatrix} \begin{bmatrix} 1 \\ 0 \\ 0 \\ 0 \end{bmatrix} = \begin{bmatrix} 0 \\ 1 \\ 0 \\ 0 \end{bmatrix}$\\[16mm]
$I \otimes X = \begin{bmatrix}
  1 \begin{bmatrix} 0 & 1 \\ 1 & 0 \\ \end{bmatrix} & 0 \begin{bmatrix} 0 & 1 \\ 1 & 0 \\ \end{bmatrix} \\[5mm]
  0 \begin{bmatrix} 0 & 1 \\ 1 & 0 \\ \end{bmatrix} & 1 \begin{bmatrix} 0 & 1 \\ 1 & 0 \\ \end{bmatrix} \\
\end{bmatrix} = \begin{bmatrix} 0 & 1 & 0 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \end{bmatrix}$ \\[16mm]
$\ket{\psi_3} = (H \otimes H) \ket{\psi_2} = \frac{1}{2} \begin{bmatrix} 1 & 1 & 1 & 1 \\ 1 & -1 & 1 & -1 \\ 1 & 1 & -1 & -1 \\ 1 & -1 & -1 & 1 \end{bmatrix} \begin{bmatrix} 0 \\ 1 \\ 0 \\ 0 \end{bmatrix} = \frac{1}{2}\begin{bmatrix} 1 \\ -1 \\ 1 \\ -1 \end{bmatrix}$ \\[16mm]
$H \otimes H = \frac{1}{\sqrt{2}\sqrt{2}} \begin{bmatrix}
  1 \begin{bmatrix} 1 & 1 \\ 1 & -1 \\ \end{bmatrix} & 1 \begin{bmatrix} 1 & 1 \\ 1 & -1 \\ \end{bmatrix} \\[5mm]
  1 \begin{bmatrix} 1 & 1 \\ 1 & -1 \\ \end{bmatrix} & -1 \begin{bmatrix} 1 & 1 \\ 1 & -1 \\ \end{bmatrix} \\
\end{bmatrix} = \frac{1}{2} \begin{bmatrix} 1 & 1 & 1 & 1 \\ 1 & -1 & 1 & 1 \\ 1 & 1 & -1 & -1 \\ 1 & 1 & -1 & 1 \end{bmatrix}$



\subsection{$U_f$}

\begin{tabular}{cc|cc|cc|cc|cc}
  { \footnotesize $x$ } & { \footnotesize $y$ } & { \footnotesize $f_{00}(x)$ } & { \footnotesize $y \oplus f_{00}(x)$ } & { \footnotesize $f_{01}(x)$ }& { \footnotesize $y \oplus f_{01}(x)$ } & { \footnotesize $f_{10}(x)$ } & { \footnotesize $y \oplus f_{10}(x)$ } & { \footnotesize $f_{11}(x)$ } & { \footnotesize$y \oplus f_{11}(x)$ } \\
  \midrule
  0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 & 1 & 1 \\
  0 & 1 & 0 & 1 & 0 & 1 & 1 & 0 & 1 & 0 \\
  1 & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 1 & 1 \\
  1 & 1 & 0 & 1 & 1 & 0 & 0 & 1 & 1 & 0 \\
\end{tabular} \\[12mm]
\noindent \begin{tabular}{c|cccc}
           & $f_{00}$ & $f_{01}$ & $f_{10}$ & $f_{11}$ \\
  \midrule
  $\ket{00}$ & $\ket{00}$ & $\ket{00}$ & $\ket{01}$ & $\ket{01}$ \\
  $\ket{01}$ & $\ket{01}$ & $\ket{01}$ & $\ket{00}$ & $\ket{00}$ \\
  $\ket{10}$ & $\ket{10}$ & $\ket{11}$ & $\ket{10}$ & $\ket{11}$ \\
  $\ket{11}$ & $\ket{11}$ & $\ket{10}$ & $\ket{11}$ & $\ket{10}$ \\ 
\end{tabular}\\[16mm]

\noindent \begin{quantikz}
  & \gate{I}\gategroup[2,steps=1,style={inner sep=6pt}]{$f_{00}$} & &\wireoverride{n} & \ctrl{1}\gategroup[2,steps=1,style={inner sep=6pt}]{$f_{01}$} & &\wireoverride{n}& \gate{I}\gategroup[2,steps=2,style={inner sep=6pt}]{$f_{10}$} & \ctrl{1} & &\wireoverride{n} & \gate{I}\gategroup[2,steps=1,style={inner sep=6pt}]{$f_{11}$} & \\
  & \gate{I} &&\wireoverride{n}  & \targ{}& &\wireoverride{n} & \gate{X} &\targ{} &&\wireoverride{n}  & \gate{X} &
\end{quantikz} \\[16mm]

$U_{00} = \begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}$\\[6mm]
$U_{01} = \begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \end{bmatrix}$\\[6mm]
$U_{10} = \begin{bmatrix} 0 & 1 & 0 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}$\\[6mm]
$U_{11} = \begin{bmatrix} 0 & 1 & 0 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \end{bmatrix}$


\subsection{$f_{00}$}
$\ket{\psi_4} = U_{00} \ket{\psi_3} = \frac{1}{2}\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}\begin{bmatrix} 1 \\ -1 \\ 1 \\ -1 \end{bmatrix} = \frac{1}{2}\begin{bmatrix} 1 \\ -1 \\ 1 \\ -1 \end{bmatrix}$\\[12mm]
\noindent$\ket{\psi_5} = (H \otimes I) \ket{\psi_4} = \frac{1}{2\sqrt{2}} \begin{bmatrix} 1 & 0 & 1 & 0 \\ 0 & 1 & 0 & 1 \\ 1 & 0 & -1 & 0 \\ 0 & 1 & 0 & -1 \end{bmatrix} \begin{bmatrix} 1 \\ -1 \\ 1 \\ -1 \end{bmatrix} = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 \\ -1 \\ 0 \\ 0 \end{bmatrix}$\\[20mm]

\subsection{$f_{01}$}
$\ket{\psi_4} = U_{01} \ket{\psi_3} = \frac{1}{2}\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \end{bmatrix}\begin{bmatrix} 1 \\ -1 \\ 1 \\ -1 \end{bmatrix} = \frac{1}{2}\begin{bmatrix} 1 \\ -1 \\ -1 \\ 1 \end{bmatrix}$\\[12mm]
\noindent$\ket{\psi_5} = (H \otimes I) \ket{\psi_4} = \frac{1}{2\sqrt{2}} \begin{bmatrix} 1 & 0 & 1 & 0 \\ 0 & 1 & 0 & 1 \\ 1 & 0 & -1 & 0 \\ 0 & 1 & 0 & -1 \end{bmatrix} \begin{bmatrix} 1 \\ -1 \\ -1 \\ 1 \end{bmatrix} = \frac{1}{\sqrt{2}} \begin{bmatrix} 0 \\ 0 \\ 1 \\ -1 \end{bmatrix}$\\[20mm]

\subsection{$f_{10}$}
$\ket{\psi_4} = U_{10} \ket{\psi_3} = \frac{1}{2}\begin{bmatrix} 0 & 1 & 0 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \end{bmatrix}\begin{bmatrix} 1 \\ -1 \\ 1 \\ -1 \end{bmatrix} = \frac{1}{2}\begin{bmatrix} -1 \\ 1 \\ 1 \\ -1 \end{bmatrix}$\\[12mm]
\noindent$\ket{\psi_5} = (H \otimes I) \ket{\psi_4} = \frac{1}{2\sqrt{2}} \begin{bmatrix} 1 & 0 & 1 & 0 \\ 0 & 1 & 0 & 1 \\ 1 & 0 & -1 & 0 \\ 0 & 1 & 0 & -1 \end{bmatrix} \begin{bmatrix} -1 \\ 1 \\ 1 \\ -1 \end{bmatrix} = \frac{1}{\sqrt{2}} \begin{bmatrix} 0 \\ 0 \\ -1 \\ 1 \end{bmatrix}$\\[20mm]

\subsection{$f_{11}$}
$\ket{\psi_4} = U_{11} \ket{\psi_3} = \frac{1}{2}\begin{bmatrix} 0 & 1 & 0 & 0 \\ 1 & 0 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \end{bmatrix}\begin{bmatrix} 1 \\ -1 \\ 1 \\ -1 \end{bmatrix} = \frac{1}{2}\begin{bmatrix} -1 \\ 1 \\ -1 \\ 1 \end{bmatrix}$\\[12mm]
\noindent$\ket{\psi_5} = (H \otimes I) \ket{\psi_4} = \frac{1}{2\sqrt{2}} \begin{bmatrix} 1 & 0 & 1 & 0 \\ 0 & 1 & 0 & 1 \\ 1 & 0 & -1 & 0 \\ 0 & 1 & 0 & -1 \end{bmatrix} \begin{bmatrix} -1 \\ 1 \\ -1 \\ 1 \end{bmatrix} = \frac{1}{\sqrt{2}} \begin{bmatrix} -1 \\ 1 \\ 0 \\ 0 \end{bmatrix}$\\[20mm]


\noindent $H \otimes I = \frac{1}{\sqrt{2}} \begin{bmatrix}
  1 \begin{bmatrix} 1 & 0 \\ 0 & 1 \\ \end{bmatrix} & 1 \begin{bmatrix} 1 & 0 \\ 0 & 1 \\ \end{bmatrix} \\[5mm]
  1 \begin{bmatrix} 1 & 0 \\ 0 & 1 \\ \end{bmatrix} & -1 \begin{bmatrix} 1 & 0 \\ 0 & 1 \\ \end{bmatrix} \\
\end{bmatrix} = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 & 0 & 1 & 0 \\ 0 & 1 & 0 & 1 \\ 1 & 0 & -1 & 0 \\ 0 & 1 & 0 & -1 \end{bmatrix}$


\subsection{Measure}

$\begin{bmatrix} a \\ b \end{bmatrix} \otimes \begin{bmatrix} c \\ d \end{bmatrix} = \begin{bmatrix} ac \\ ad \\ bc \\ bd \end{bmatrix}$ \\[12mm]
$\begin{bmatrix} ac \\ ad \\ bc \\ bd \end{bmatrix} = \begin{bmatrix} 0 \\ 0 \\ 1 \\ -1 \end{bmatrix}$ \\[12mm]
$ac = 0 \Rightarrow a = 0 \textsf{ or } c = 0$ \\[6mm]
$bc = 1 \Rightarrow b \neq 0 \textsf{ and } c \neq 0$ \\[6mm]
$\Rightarrow a = 0$ \\[6mm]
$|a|^2 + |b|^2 = 1$ \\[6mm]
$\Rightarrow |b|^2 = 1$ \\[6mm]

\end{document}